---
title: "Statistical Trending on Medical Device Surveillance Data"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Medical Device Surveillance Statistical Trending}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
load(file="../data/mds_ts.rda")
library(mdsstat)
```

The `mdsstat` package:

- Standardizes the output of various statistical trending algorithms
- Allows running of multiple algorithms on the same data
- Allows running of both **disproportionality** and **quality control** algorithms
- Creates lightweight analysis definitions and output files for auditability, documentation, and reproducibility

**Why?**

There are many ways to trend medical device event data. Some are drawn from the [quality control](https://en.wikipedia.org/wiki/Quality_control) discipline, others from disproportionality analysis used in pharmacoepidemiology, and yet others from the general field of statistics.

There is a need to rigorously compare and contrast these various methods to more fully understand their respective performance and applicability in surveillance of medical devices. To date, published literature and regulatory guidelines lack comprehensive reviews or clear directions on the statistics of medical device surveillance.

**How?**

The `mdsstat` package aims to provide a collection of statistical trending algorithms used in medical device surveillance. Furthermore, each algorithm is written with a standardized, reusable framework philosophy. The same input data can be fed through multiple algorithms. All algorithms return **results that can be sorted, stacked, and compared.**

This package is written in tandem with the `mds` package. These are complementary in the sense that:

- `mds` standardizes medical device event data.
- `mdsstat` standardizes the statistical trending of medical device event data.

While `mdsstat` algorithms can run on generic R data frames, additional efficiency and traceability benefits are derived by running on data frames generated by `mds::time_series()` from the `mds` package.

**Purpose of This Vignette**

- Introduce [the algorithms](#algos)
- Show how to [run one algorithm](#onealgo)
- Show how to run [multiple algorithms](#mutlialgo)

## Data: MAUDE Time Series Generated from `mds::time_series()`

The following examples use a sample list of three time series generated by `mds::time_series()` from the `mds` package, saved as `mds_ts` in this package. The underlying datat were queried from the [FDA MAUDE API](https://open.fda.gov/api/). Furthermore, a simulated exposure dataset `sales` was generated to provide exposure data.

```{r}
library(mdsstat)
data(mds_ts)
```


## The Algorithms {#algos}

This is the current list of algorithms available:

Function            Description
-----------------   ------------------------------------------------------------
`shewhart()`        Shewhart x-bar Control Chart with 4 Western Electric Rules
`prr()`             Proportional Reporting Ratio
`poisson_rare()`    Poisson Test on Rare Events

These are planned/proposed algorithms to add:

Function            Description
-----------------   ------------------------------------------------------------
`ebgm()`            Empirical Bayes Geometric Mean (basis of the Gamma Poisson Shrinker)
`bcpnn()`           Bayesian Confidence Propagation Neural Network
`ror()`             Reporting Odds Ratio
`chi_square()`      Chi-Square Test
`poisson_rare()`    Poisson Test on Rare Events
`changepoint()`     Binary Segmentation Changepoint
`cusum()`           Cumulative Sum Control Chart with 4 Western Electric Rules
`ewma()`            Exponentially Weighted Moving Average with 4 WE Rules
`cox_stuart()`      Cox-Stuart Test
`uptrend()`         Linear Uptrend by Linear Modeling


## Run One Algorithm {#onealgo}


## Run Multiple Algorithms {#mutlialgo}
